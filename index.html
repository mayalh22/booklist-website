<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Interactive Booklist</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    
    :root {
      --primary: #6366f1;
      --primary-dark: #4338ca;
      --secondary: #8b5cf6;
      --accent: #f59e0b;
      --bg-light: #fafafa;
      --bg-dark: #0f0f23;
      --card-light: #ffffff;
      --card-dark: #1a1a2e;
      --text-light: #1f2937;
      --text-muted-light: #6b7280;
      --text-dark: #f9fafb;
      --text-muted-dark: #d1d5db;
      --shadow-light: rgba(0, 0, 0, 0.1);
      --shadow-dark: rgba(0, 0, 0, 0.3);
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      transition: all 0.4s ease;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      line-height: 1.6;
    }
    
    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    
    /* Animated background particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(120, 219, 255, 0.3) 0%, transparent 50%);
      z-index: -1;
      opacity: 0.4;
      animation: float 20s ease-in-out infinite;
    }
    
    body.dark::before {
      opacity: 0.2;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      33% { transform: translateY(-20px) rotate(1deg); }
      66% { transform: translateY(10px) rotate(-1deg); }
    }
    
    header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      padding: 2rem 1rem;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 32px var(--shadow-light);
      backdrop-filter: blur(10px);
    }
    
    body.dark header {
      box-shadow: 0 8px 32px var(--shadow-dark);
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shine 3s infinite;
    }
    
    @keyframes shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3rem;
      font-weight: 700;
      margin: 0;
      background: linear-gradient(45deg, #fff, #e0e7ff);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      animation: titleGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes titleGlow {
      from { filter: drop-shadow(0 0 5px rgba(255,255,255,0.5)); }
      to { filter: drop-shadow(0 0 15px rgba(255,255,255,0.8)); }
    }
    
    header .tagline {
      font-style: italic;
      margin: 0.5rem 0 2rem;
      font-family: 'Playfair Display', serif;
      font-size: 1.2rem;
      opacity: 0.9;
      animation: fadeInUp 1s ease 0.5s both;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 0.9;
        transform: translateY(0);
      }
    }
    
    .controls {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex-wrap: wrap;
      margin-top: 1rem;
      animation: fadeInUp 1s ease 0.7s both;
    }
    
    .search-container {
      position: relative;
    }
    
    .controls input[type="search"] {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      border-radius: 50px;
      border: 2px solid rgba(255,255,255,0.3);
      width: 300px;
      max-width: 90vw;
      outline: none;
      background: rgba(255,255,255,0.1);
      color: white;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }
    
    .controls input[type="search"]::placeholder {
      color: rgba(255,255,255,0.7);
    }
    
    .controls input[type="search"]:focus {
      border-color: rgba(255,255,255,0.6);
      box-shadow: 0 0 20px rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    
    .controls button {
      cursor: pointer;
      border: 2px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.1);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-weight: 600;
      font-family: 'Inter', sans-serif;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .controls button:hover,
    .controls button:focus {
      border-color: rgba(255,255,255,0.6);
      box-shadow: 0 0 20px rgba(255,255,255,0.3);
      transform: translateY(-2px);
      outline: none;
    }
    
    .controls button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }
    
    .controls button:hover::before {
      left: 100%;
    }

    main.book-grid {
      flex-grow: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 2rem;
      padding: 3rem 2rem;
      max-width: 1400px;
      margin: auto;
      width: 100%;
    }
    
    .book-card {
      background: var(--card-light);
      border-radius: 20px;
      box-shadow: 0 10px 30px var(--shadow-light);
      padding: 1.5rem;
      cursor: pointer;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      user-select: none;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
    }
    
    body.dark .book-card {
      background: var(--card-dark);
      box-shadow: 0 10px 30px var(--shadow-dark);
      border-color: rgba(255,255,255,0.1);
    }
    
    .book-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-1);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .book-card:nth-child(3n+2)::before {
      background: var(--gradient-2);
    }
    
    .book-card:nth-child(3n+3)::before {
      background: var(--gradient-3);
    }
    
    .book-card:hover::before,
    .book-card:focus::before {
      transform: scaleX(1);
    }
    
    .book-card:hover,
    .book-card:focus {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 50px var(--shadow-light);
      outline: none;
    }
    
    body.dark .book-card:hover,
    body.dark .book-card:focus {
      box-shadow: 0 20px 50px var(--shadow-dark);
    }
    
    .book-cover-container {
      position: relative;
      margin-bottom: 1.5rem;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    .book-card img {
      width: 180px;
      height: 270px;
      object-fit: cover;
      border-radius: 12px;
      transition: transform 0.3s ease;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1rem;
      text-align: center;
    }
    
    .book-card:hover img {
      transform: scale(1.05);
    }
    
    .book-card h2 {
      font-family: 'Playfair Display', serif;
      margin: 0 0 0.5rem;
      font-size: 1.3rem;
      font-weight: 700;
      text-align: center;
      user-select: text;
      line-height: 1.3;
      color: var(--text-light);
    }
    
    body.dark .book-card h2 {
      color: var(--text-dark);
    }
    
    .book-card .author {
      font-style: italic;
      color: var(--text-muted-light);
      margin-bottom: 1rem;
      user-select: text;
      font-weight: 500;
      font-size: 0.95rem;
    }
    
    body.dark .book-card .author {
      color: var(--text-muted-dark);
    }
    
    .fav-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: rgba(255,255,255,0.9);
      font-size: 1.4rem;
      color: var(--accent);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
    }
    
    body.dark .fav-btn {
      background: rgba(0,0,0,0.7);
    }
    
    .fav-btn:hover,
    .fav-btn:focus {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3);
      outline: none;
    }
    
    .fav {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.05) 100%);
      border: 2px solid rgba(245, 158, 11, 0.3);
    }

    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.4s ease forwards;
      z-index: 100;
      padding: 2rem;
      backdrop-filter: blur(10px);
    }
    
    .modal-content {
      background: var(--card-light);
      border-radius: 24px;
      padding: 3rem;
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      color: var(--text-light);
      box-shadow: 0 25px 50px var(--shadow-dark);
      border: 1px solid rgba(255,255,255,0.2);
      backdrop-filter: blur(20px);
      animation: slideUp 0.4s ease forwards;
    }
    
    @keyframes slideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    body.dark .modal-content {
      background: var(--card-dark);
      color: var(--text-dark);
      border-color: rgba(255,255,255,0.1);
    }
    
    .modal-cover {
      width: 200px;
      height: 300px;
      object-fit: cover;
      float: left;
      margin-right: 2rem;
      border-radius: 16px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.3);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .modal-content h2 {
      font-family: 'Playfair Display', serif;
      margin-top: 0;
      margin-bottom: 0.5rem;
      font-size: 2.2rem;
      font-weight: 700;
      line-height: 1.2;
    }
    
    .modal-content h3 {
      margin-top: 0;
      font-weight: 500;
      font-style: italic;
      color: var(--text-muted-light);
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
    }
    
    body.dark .modal-content h3 {
      color: var(--text-muted-dark);
    }
    
    .modal-content p {
      line-height: 1.7;
      user-select: text;
      font-size: 1.05rem;
      margin-bottom: 2rem;
    }
    
    .close-btn {
      position: absolute;
      top: 20px;
      right: 25px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      width: 45px;
      height: 45px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-muted-light);
      font-weight: 400;
      user-select: none;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    body.dark .close-btn {
      background: rgba(0,0,0,0.3);
      border-color: rgba(255,255,255,0.1);
      color: var(--text-muted-dark);
    }
    
    .close-btn:hover,
    .close-btn:focus {
      background: rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.3);
      color: #ef4444;
      transform: scale(1.1);
      outline: none;
    }
    
    .fav-btn.large {
      font-size: 1rem;
      margin-top: 2rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      padding: 1rem 2rem;
      border-radius: 50px;
      color: white;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      user-select: none;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-family: 'Inter', sans-serif;
    }
    
    .fav-btn.large:hover,
    .fav-btn.large:focus {
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
      outline: none;
    }

    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }

    footer {
      padding: 2rem 1rem;
      text-align: center;
      color: var(--text-muted-light);
      font-size: 0.9rem;
      user-select: none;
      background: rgba(255,255,255,0.5);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255,255,255,0.2);
    }
    
    body.dark footer {
      color: var(--text-muted-dark);
      background: rgba(0,0,0,0.3);
      border-top-color: rgba(255,255,255,0.1);
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2rem;
      }
      
      header .tagline {
        font-size: 1rem;
      }
      
      .controls {
        gap: 1rem;
      }
      
      .controls input[type="search"] {
        width: 280px;
      }
      
      .modal-content {
        padding: 2rem 1.5rem;
        margin: 1rem;
      }
      
      .modal-cover {
        float: none;
        display: block;
        margin: 0 auto 1.5rem;
        width: 160px;
        height: 240px;
      }
      
      main.book-grid {
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 1.5rem;
        padding: 2rem 1rem;
      }
      
      .book-card img {
        width: 150px;
        height: 225px;
      }
      
      .modal-content h2 {
        font-size: 1.8rem;
        text-align: center;
      }
      
      .modal-content h3 {
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>My Booklist</h1>
    <p class="tagline">A curated collection of literary treasures</p>
    <div class="controls">
      <div class="search-container">
        <input
          type="search"
          id="search-input"
          placeholder="Search by title or author..."
          aria-label="Search books"
        />
      </div>
      <button id="dark-mode-toggle" aria-pressed="false" aria-label="Toggle dark mode">🌙 Dark Mode</button>
    </div>
  </header>

  <main class="book-grid" id="book-grid" tabindex="0" aria-live="polite">
    <!-- Book cards inserted here by JS -->
  </main>

  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title" tabindex="-1" hidden>
    <div class="modal-content" role="document">
      <button class="close-btn" aria-label="Close modal">×</button>
      <img src="" alt="" class="modal-cover" />
      <h2 id="modal-title"></h2>
      <h3></h3>
      <p></p>
      <button class="fav-btn large" aria-label="Toggle favorite">
        <span class="star">★</span>
        <span class="text">Add to favorites</span>
      </button>
    </div>
  </div>

  <footer>
    <p>Created with ❤️ and a love for great literature</p>
  </footer>

<script>
  (function() {
    const books = [
      {
        id: 1,
        title: "Monday's Not Coming",
        author: "Tiffany D. Jackson",
        cover: "https://via.placeholder.com/180x270/667eea/ffffff?text=Monday's+Not+Coming",
        description: "This gripping thriller follows Claudia as she investigates the mysterious disappearance of her best friend, Monday. As the adults around her dismiss her concerns, Claudia uncovers disturbing truths about systemic neglect. The novel powerfully explores themes of friendship, mental health, and the invisibility of Black girls in society. Jackson's narrative style is raw and immersive. The story is both heartbreaking and eye-opening, keeping readers questioning until the very end."
      },
      {
        id: 2,
        title: "Behold the Dreamers",
        author: "Imbolo Mbue",
        cover: "https://via.placeholder.com/180x270/764ba2/ffffff?text=Behold+the+Dreamers",
        description: "Set during the 2008 financial crisis, this novel tells the story of a Cameroonian immigrant family chasing the American dream. Jende Jonga lands a job driving for a wealthy Lehman Brothers executive, exposing the stark contrasts between classes. As the economy crumbles, so does the illusion of security for both families. The book delves into immigration, ambition, and sacrifice. Mbue's writing is both compassionate and unflinching, offering a layered view of the immigrant experience."
      },
      {
        id: 3,
        title: "The Corrections",
        author: "Jonathan Franzen",
        cover: "https://via.placeholder.com/180x270/f093fb/ffffff?text=The+Corrections",
        description: "This modern family saga follows the dysfunctional Lambert family as they grapple with aging, disappointment, and personal failures. Told through the perspectives of each family member, the novel is both darkly humorous and emotionally intense. Franzen captures the tension between traditional values and modern chaos. The characters are flawed yet deeply human, making their struggles feel relatable. The writing is richly detailed and often biting in its social commentary."
      },
      {
        id: 4,
        title: "A Raisin in the Sun",
        author: "Lorraine Hansberry",
        cover: "https://via.placeholder.com/180x270/f5576c/ffffff?text=A+Raisin+in+the+Sun",
        description: "This iconic play portrays a Black family's pursuit of a better life on Chicago's South Side. When the Youngers receive a life insurance check, dreams clash and tensions rise. Each character envisions a different future, revealing generational and ideological divides. Hansberry explores themes of racism, identity, and hope with depth and clarity. The story remains a powerful reflection on systemic injustice and the resilience of family bonds."
      },
      {
        id: 5,
        title: "The Namesake",
        author: "Jhumpa Lahiri",
        cover: "https://via.placeholder.com/180x270/4facfe/ffffff?text=The+Namesake",
        description: "This novel follows Gogol Ganguli, the American-born son of Bengali immigrants, as he struggles with his cultural identity. Named after the Russian author Nikolai Gogol, he grapples with his unusual name and the weight of family expectations. Lahiri explores the immigrant experience with nuance and grace. The book is a meditation on heritage, belonging, and the ways we define ourselves. Lahiri's prose is quiet but powerful, making ordinary moments deeply affecting."
      },
      {
        id: 6,
        title: "Interpreter of Maladies",
        author: "Jhumpa Lahiri",
        cover: "https://via.placeholder.com/180x270/00f2fe/ffffff?text=Interpreter+of+Maladies",
        description: "This Pulitzer Prize-winning collection of short stories explores the lives of Indian and Indian-American characters navigating cultural transitions. Each story captures subtle emotional shifts and quiet revelations. Lahiri's characters are often caught between tradition and modernity, loneliness and connection. Her writing is elegant, restrained, and rich with insight. The collection offers a poignant exploration of identity and human vulnerability."
      },
      {
        id: 7,
        title: "Eleanor Oliphant is Completely Fine",
        author: "Gail Honeyman",
        cover: "https://via.placeholder.com/180x270/667eea/ffffff?text=Eleanor+Oliphant+is+Fine",
        description: "Eleanor Oliphant lives a routine, isolated life until an unexpected friendship begins to transform her world. As the layers of her past are slowly revealed, Eleanor's resilience and pain come into focus. The novel balances heartbreak and humor with grace. Honeyman creates a unique and unforgettable character who challenges our ideas of mental health and healing. It's an uplifting story about connection, loneliness, and second chances."
      },
      {
        id: 8,
        title: "The Alchemist",
        author: "Paulo Coelho",
        cover: "https://via.placeholder.com/180x270/764ba2/ffffff?text=The+Alchemist",
        description: "This philosophical novel follows Santiago, a shepherd boy who dreams of finding treasure in Egypt. Along his journey, he meets mentors, faces challenges, and discovers deeper truths about destiny and purpose. Coelho's writing is simple yet profound, filled with symbolism and spiritual insight. The story encourages readers to follow their personal legend and listen to their hearts. It's a timeless fable about dreams, faith, and self-discovery."
      },
      {
        id: 9,
        title: "The Phantom Tollbooth",
        author: "Norton Juster",
        cover: "https://via.placeholder.com/180x270/f093fb/ffffff?text=The+Phantom+Tollbooth",
        description: "This whimsical adventure follows a bored boy named Milo who drives through a magical tollbooth into a world of wordplay and imagination. Along the way, he meets eccentric characters like Tock the watchdog and the Humbug. The story is both humorous and deeply philosophical, encouraging curiosity and critical thinking. Juster blends puns and parables to create a clever, entertaining tale. It's a celebration of learning, wonder, and the joy of discovery."
      },
    ];

    // Cached DOM elements
    const bookGrid = document.getElementById('book-grid');
    const searchInput = document.getElementById('search-input');
    const modal = document.getElementById('modal');
    const modalTitle = modal.querySelector('#modal-title');
    const modalAuthor = modal.querySelector('h3');
    const modalDescription = modal.querySelector('p');
    const modalCover = modal.querySelector('.modal-cover');
    const modalCloseBtn = modal.querySelector('.close-btn');
    const modalFavBtn = modal.querySelector('.fav-btn.large');
    const modalFavText = modalFavBtn.querySelector('.text');
    const modalFavStar = modalFavBtn.querySelector('.star');
    const darkModeToggle = document.getElementById('dark-mode-toggle');

    // State
    let favorites = new Set();
    let filteredBooks = [...books];
    let currentModalBookId = null;

    // Create a book card DOM node
    function createBookCard(book) {
      const card = document.createElement('div');
      card.className = 'book-card';
      card.setAttribute('tabindex', '0');
      card.setAttribute('role', 'button');
      card.setAttribute('aria-pressed', favorites.has(book.id) ? 'true' : 'false');
      card.setAttribute('aria-label', `View details for ${book.title} by ${book.author}`);

      const coverContainer = document.createElement('div');
      coverContainer.className = 'book-cover-container';

      const img = document.createElement('img');
      img.src = book.cover;
      img.alt = `Cover of ${book.title}`;
      img.onerror = function() {
        // Fallback to gradient background with title
        this.style.background = `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`;
        this.style.display = 'flex';
        this.style.alignItems = 'center';
        this.style.justifyContent = 'center';
        this.style.fontSize = '0.9rem';
        this.style.fontWeight = '600';
        this.style.textAlign = 'center';
        this.style.padding = '1rem';
        this.style.color = 'white';
        this.innerHTML = book.title;
      };

      const h2 = document.createElement('h2');
      h2.textContent = book.title;

      const author = document.createElement('p');
      author.className = 'author';
      author.textContent = `by ${book.author}`;

      const favBtn = document.createElement('button');
      favBtn.className = 'fav-btn';
      favBtn.innerHTML = favorites.has(book.id) ? '★' : '☆';
      favBtn.title = favorites.has(book.id) ? 'Remove from favorites' : 'Add to favorites';
      favBtn.setAttribute('aria-label', favBtn.title);
      favBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleFavorite(book.id, favBtn, card);
      });

      if (favorites.has(book.id)) {
        card.classList.add('fav');
      }

      coverContainer.appendChild(img);
      card.appendChild(coverContainer);
      card.appendChild(h2);
      card.appendChild(author);
      card.appendChild(favBtn);

      // Click / keyboard enter opens modal
      card.addEventListener('click', () => openModal(book.id));
      card.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openModal(book.id);
        }
      });

      return card;
    }

    function toggleFavorite(bookId, btn, card) {
      if (favorites.has(bookId)) {
        favorites.delete(bookId);
        btn.innerHTML = '☆';
        btn.title = 'Add to favorites';
        card.classList.remove('fav');
      } else {
        favorites.add(bookId);
        btn.innerHTML = '★';
        btn.title = 'Remove from favorites';
        card.classList.add('fav');
      }
      btn.setAttribute('aria-label', btn.title);
    }

    // Render book cards to grid
    function renderBooks(bookList) {
      bookGrid.innerHTML = '';
      if (bookList.length === 0) {
        const msg = document.createElement('div');
        msg.style.gridColumn = '1/-1';
        msg.style.textAlign = 'center';
        msg.style.padding = '3rem';
        msg.style.fontSize = '1.2rem';
        msg.style.color = 'var(--text-muted-light)';
        msg.innerHTML = `
          <div style="font-size: 4rem; margin-bottom: 1rem;">📚</div>
          <p>No books found matching your search.</p>
          <p style="font-size: 1rem; margin-top: 0.5rem;">Try adjusting your search terms.</p>
        `;
        bookGrid.appendChild(msg);
        return;
      }
      bookList.forEach((book, index) => {
        const card = createBookCard(book);
        card.style.animationDelay = `${index * 0.1}s`;
        card.style.animation = 'fadeInUp 0.6s ease forwards';
        bookGrid.appendChild(card);
      });
    }

    // Filter books based on search input
    function filterBooks(query) {
      const q = query.trim().toLowerCase();
      filteredBooks = books.filter(book =>
        book.title.toLowerCase().includes(q) || book.author.toLowerCase().includes(q)
      );
      renderBooks(filteredBooks);
    }

    // Open modal with book details
    function openModal(bookId) {
      const book = books.find(b => b.id === bookId);
      if (!book) return;

      currentModalBookId = bookId;
      modalTitle.textContent = book.title;
      modalAuthor.textContent = `by ${book.author}`;
      modalDescription.textContent = book.description;
      modalCover.src = book.cover;
      modalCover.alt = `Cover of ${book.title}`;
      
      // Handle modal cover image error
      modalCover.onerror = function() {
        this.style.background = `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`;
        this.style.display = 'flex';
        this.style.alignItems = 'center';
        this.style.justifyContent = 'center';
        this.style.fontSize = '1rem';
        this.style.fontWeight = '600';
        this.style.textAlign = 'center';
        this.style.padding = '1rem';
        this.style.color = 'white';
        this.innerHTML = book.title;
      };

      // Set favorite btn text & aria-label
      if (favorites.has(bookId)) {
        modalFavStar.textContent = '★';
        modalFavText.textContent = 'Remove from favorites';
        modalFavBtn.setAttribute('aria-label', `Remove ${book.title} from favorites`);
      } else {
        modalFavStar.textContent = '☆';
        modalFavText.textContent = 'Add to favorites';
        modalFavBtn.setAttribute('aria-label', `Add ${book.title} to favorites`);
      }

      modal.setAttribute('aria-hidden', 'false');
      modal.hidden = false;
      modal.focus();
      document.body.style.overflow = 'hidden';
    }

    // Close modal
    function closeModal() {
      currentModalBookId = null;
      modal.setAttribute('aria-hidden', 'true');
      modal.hidden = true;
      document.body.style.overflow = '';
    }

    // Toggle favorite from modal
    modalFavBtn.addEventListener('click', () => {
      if (currentModalBookId == null) return;
      const bookId = currentModalBookId;
      if (favorites.has(bookId)) {
        favorites.delete(bookId);
        modalFavStar.textContent = '☆';
        modalFavText.textContent = 'Add to favorites';
        modalFavBtn.setAttribute('aria-label', `Add book to favorites`);
      } else {
        favorites.add(bookId);
        modalFavStar.textContent = '★';
        modalFavText.textContent = 'Remove from favorites';
        modalFavBtn.setAttribute('aria-label', `Remove book from favorites`);
      }
      // Also update the card on page
      renderBooks(filteredBooks);
    });

    modalCloseBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', e => {
      if (e.target === modal) closeModal();
    });

    // Keyboard navigation for modal
    document.addEventListener('keydown', e => {
      if (!modal.hidden && e.key === 'Escape') {
        closeModal();
      }
    });

    // Dark mode toggle
    function setDarkMode(on) {
      if (on) {
        document.body.classList.add('dark');
        darkModeToggle.innerHTML = '☀️ Light Mode';
        darkModeToggle.setAttribute('aria-pressed', 'true');
      } else {
        document.body.classList.remove('dark');
        darkModeToggle.innerHTML = '🌙 Dark Mode';
        darkModeToggle.setAttribute('aria-pressed', 'false');
      }
    }
    
    darkModeToggle.addEventListener('click', () => {
      setDarkMode(!document.body.classList.contains('dark'));
    });
    
    // Initialize dark mode (default to light)
    setDarkMode(false);

    // Search input listener
    searchInput.addEventListener('input', e => {
      filterBooks(e.target.value);
    });

    // Add some CSS animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    `;
    document.head.appendChild(style);

    // Initial render
    renderBooks(books);
  })();
</script>
</body>
</html>
